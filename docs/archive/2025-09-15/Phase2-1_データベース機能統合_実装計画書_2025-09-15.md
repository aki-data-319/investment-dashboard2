# Phase 2.1 データベース機能統合 - 実装計画書

**作成日**: 2025年9月15日  
**対象プロジェクト**: 投資ダッシュボード v2  
**フェーズ**: Phase 2.1 - データベース機能の完全移植  
**期間**: Week 1-2 (Day 1-12)  

---

## 🎯 フェーズ概要

**目標**: 23版で実装済みのデータベースUI機能をv2レイヤードアーキテクチャに完全統合  
**優先度**: 【最高優先】- 実用的価値を即座に提供する重要機能  
**移植基盤**: 23版 Phase 3で85%完成済み（Task 1-3完了、Task 4-5は未完了）  

### **重要な前提条件**
- v2の基本3画面（Dashboard/AssetForm/CsvImport）は完全実装済み
- DataStoreManager/AssetRepository/Router.js は拡張準備完了
- 23版のデータベース機能コードベースが参照可能

---

## 📋 4つの実装タスク

### **🔥 Task 2.1.1: データベースページ基盤実装** (Day 1-2)
**移植元**: 23_investment-dashboard Phase 3 Task 1-2 (完了済み)

#### **作成ファイル**
```
src/ui/views/DatabaseView.js                    // 新規作成
src/ui/controllers/DatabaseController.js        // 新規作成
src/ui/Router.js                                // 拡張（4タブ目追加）
public/index.html                               // 拡張（Database画面追加）
```

#### **実装内容**
1. **DatabaseView.js作成**
   ```javascript
   /**
    * データベース画面のメインビュークラス
    * @description 取引履歴・銘柄情報・編集履歴の3タブ統合管理
    */
   class DatabaseView {
       constructor() {
           this.activeTab = 'transactions';
           this.initializeElements();
           this.setupEventListeners();
       }
   
       /**
        * データベース画面のHTML構造を生成
        * @returns {string} 完全なHTML構造
        */
       render() {
           return `
               <div id="databasePage" class="page-content database-page">
                   <div class="database-header">
                       <h1>🗂️ 投資データベース</h1>
                       <div class="database-tabs">
                           <button class="tab-btn active" data-tab="transactions">
                               📈 取引履歴
                           </button>
                           <button class="tab-btn" data-tab="assets">
                               🏢 銘柄情報
                           </button>
                           <button class="tab-btn" data-tab="history">
                               📝 編集履歴
                           </button>
                       </div>
                   </div>
                   <div class="database-content">
                       <div id="transactionsTab" class="tab-content active">
                           <!-- 取引履歴タブ内容 -->
                       </div>
                       <div id="assetsTab" class="tab-content">
                           <!-- 銘柄情報タブ内容 -->
                       </div>
                       <div id="historyTab" class="tab-content">
                           <!-- 編集履歴タブ内容 -->
                       </div>
                   </div>
               </div>
           `;
       }
   }
   ```

2. **DatabaseController.js作成**
   ```javascript
   /**
    * データベース画面の制御クラス
    * @description ナビゲーション・タブ切り替え・データ連携を管理
    */
   class DatabaseController {
       constructor(dataStoreManager) {
           this.dataStoreManager = dataStoreManager;
           this.view = new DatabaseView();
           this.currentTab = 'transactions';
       }
   
       /**
        * データベースページを表示
        * @description メインダッシュボードから遷移
        */
       showDatabase() {
           // 他のページを非表示
           document.getElementById('dashboard').style.display = 'none';
           document.getElementById('assetForm').style.display = 'none';
           document.getElementById('csvImport').style.display = 'none';
           
           // データベースページを表示
           const databaseContainer = document.getElementById('databaseContainer');
           databaseContainer.innerHTML = this.view.render();
           databaseContainer.style.display = 'block';
           
           // デフォルトで取引履歴タブを表示
           this.loadTransactionsTab();
       }
   
       /**
        * タブ切り替え処理
        * @param {string} tabName - 切り替え先タブ名
        */
       switchTab(tabName) {
           // アクティブタブの切り替え
           document.querySelectorAll('.tab-btn').forEach(btn => {
               btn.classList.remove('active');
           });
           document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
   
           // タブコンテンツの切り替え
           document.querySelectorAll('.tab-content').forEach(content => {
               content.classList.remove('active');
           });
           document.getElementById(`${tabName}Tab`).classList.add('active');
   
           this.currentTab = tabName;
           this.loadTabContent(tabName);
       }
       
       /**
        * タブ別コンテンツ読み込み
        * @param {string} tabName - 読み込み対象タブ
        */
       loadTabContent(tabName) {
           switch (tabName) {
               case 'transactions':
                   this.loadTransactionsTab();
                   break;
               case 'assets':
                   this.loadAssetsTab();
                   break;
               case 'history':
                   this.loadHistoryTab();
                   break;
           }
       }
   }
   ```

3. **Router.js拡張**
   ```javascript
   // 既存のRouter.jsに追加
   class Router {
       // 既存メソッド...
       
       /**
        * データベース画面への遷移
        */
       showDatabase() {
           this.hideAllPages();
           this.databaseController.showDatabase();
           this.updateNavigation('database');
       }
       
       /**
        * ナビゲーションの更新（4タブ対応）
        */
       updateNavigation(currentPage) {
           const navButtons = {
               dashboard: document.getElementById('navDashboard'),
               assetForm: document.getElementById('navAssetForm'),
               csvImport: document.getElementById('navCsvImport'),
               database: document.getElementById('navDatabase')  // 追加
           };
           
           Object.entries(navButtons).forEach(([page, button]) => {
               if (button) {
                   button.classList.toggle('active', page === currentPage);
               }
           });
       }
   }
   ```

4. **index.html拡張**
   ```html
   <!-- 既存のナビゲーションに追加 -->
   <nav class="main-navigation">
       <button id="navDashboard" onclick="router.showDashboard()">📊 Dashboard</button>
       <button id="navAssetForm" onclick="router.showAssetForm()">➕ Asset Form</button>
       <button id="navCsvImport" onclick="router.showCsvImport()">📤 CSV Import</button>
       <button id="navDatabase" onclick="router.showDatabase()">🗂️ Database</button>
   </nav>
   
   <!-- データベースページコンテナ追加 -->
   <div id="databaseContainer" class="page-container" style="display: none;">
       <!-- DatabaseView.jsで動的生成 -->
   </div>
   ```

#### **完了基準**
- [x] 4タブナビゲーションの完全動作
- [x] データベースページの表示・非表示切り替え
- [x] 3つの内部タブ（取引履歴・銘柄情報・編集履歴）切り替え
- [x] 既存3画面との完全な相互運用

---

### **🔥 Task 2.1.2: 取引履歴データベース完全実装** (Day 3-5)
**移植元**: 23_investment-dashboard Phase 3 Task 3 (完了済み)

#### **作成ファイル**
```
src/business/services/TransactionDatabaseService.js    // 新規作成
src/ui/components/TransactionTable.js                  // 新規作成
```

#### **実装内容**
1. **TransactionDatabaseService.js作成**
   ```javascript
   /**
    * 取引履歴データベース管理サービス
    * @description 全取引データの統合・フィルタリング・検索機能を提供
    */
   class TransactionDatabaseService {
       constructor(dataStoreManager) {
           this.dataStoreManager = dataStoreManager;
           this.transactionCache = new Map();
       }
   
       /**
        * 全取引データを統合取得
        * @returns {Array<Object>} 統合された取引データ
        * @example
        * // 返却データ形式
        * [
        *   {
        *     id: "unique_id",
        *     date: "2025-09-01",
        *     name: "Apple Inc.",
        *     type: "stock",
        *     quantity: 100,
        *     unitPrice: 150.25,
        *     amount: 15025,
        *     region: "US",
        *     currency: "USD"
        *   }
        * ]
        */
       getAllTransactions() {
           const assets = this.dataStoreManager.getAllAssets();
           const transactions = [];
   
           // 投資信託
           assets.mutualFunds?.forEach(mf => {
               transactions.push({
                   id: mf.id,
                   date: mf.createdAt || mf.date,
                   name: mf.name,
                   type: 'mutualFund',
                   quantity: '-',
                   unitPrice: '-',
                   amount: mf.amount,
                   region: 'JP',
                   currency: 'JPY',
                   account: '特定',
                   source: 'manual'
               });
           });
   
           // 個別株
           assets.stocks?.forEach(stock => {
               transactions.push({
                   id: stock.id,
                   date: stock.createdAt || stock.date,
                   name: stock.name,
                   ticker: stock.ticker,
                   type: 'stock',
                   quantity: stock.quantity,
                   unitPrice: stock.unitPrice,
                   amount: stock.amount,
                   region: stock.region || 'JP',
                   currency: stock.settlementCurrency || 'JPY',
                   account: stock.account || '特定',
                   sector: stock.sector,
                   source: stock.source || 'manual'
               });
           });
   
           // 仮想通貨
           assets.cryptoAssets?.forEach(crypto => {
               transactions.push({
                   id: crypto.id,
                   date: crypto.createdAt || crypto.date,
                   name: crypto.name,
                   type: 'crypto',
                   quantity: crypto.quantity,
                   unitPrice: crypto.unitPrice,
                   amount: crypto.amount,
                   region: 'Global',
                   currency: 'JPY',
                   source: 'manual'
               });
           });
   
           // 日付順にソート（最新が先頭）
           return transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
       }
   
       /**
        * フィルタリング処理
        * @param {Array} transactions - 元の取引データ
        * @param {Object} filters - フィルター条件
        * @param {string} searchKeyword - 検索キーワード
        * @returns {Array} フィルタリング済みデータ
        */
       applyFilters(transactions, filters, searchKeyword = '') {
           let filtered = [...transactions];
   
           // 種別フィルター
           if (filters.type && filters.type !== '') {
               filtered = filtered.filter(t => t.type === filters.type);
           }
   
           // 地域フィルター
           if (filters.region && filters.region !== '') {
               filtered = filtered.filter(t => t.region === filters.region);
           }
   
           // 通貨フィルター
           if (filters.currency && filters.currency !== '') {
               filtered = filtered.filter(t => t.currency === filters.currency);
           }
   
           // キーワード検索（銘柄名・ティッカー）
           if (searchKeyword.trim() !== '') {
               const keyword = searchKeyword.toLowerCase();
               filtered = filtered.filter(t => 
                   t.name.toLowerCase().includes(keyword) ||
                   (t.ticker && t.ticker.toLowerCase().includes(keyword))
               );
           }
   
           return filtered;
       }
   
       /**
        * 表示制限（最新50件）
        * @param {Array} transactions - 取引データ
        * @returns {Array} 表示用に制限されたデータ
        */
       limitForDisplay(transactions, limit = 50) {
           return transactions.slice(0, limit);
       }
   }
   ```

2. **TransactionTable.js作成**
   ```javascript
   /**
    * 取引履歴テーブル表示コンポーネント
    * @description フィルタリング機能付きの高度なテーブル表示
    */
   class TransactionTable {
       constructor(transactionDatabaseService) {
           this.service = transactionDatabaseService;
           this.currentFilters = {
               type: '',
               region: '',
               currency: ''
           };
           this.searchKeyword = '';
       }
   
       /**
        * 取引履歴テーブル全体のHTML生成
        * @returns {string} 完全なテーブルHTML
        */
       render() {
           return `
               <div class="transaction-database-container">
                   ${this.renderFilters()}
                   ${this.renderTable()}
               </div>
           `;
       }
   
       /**
        * フィルターバーのHTML生成
        * @returns {string} フィルターUIのHTML
        */
       renderFilters() {
           return `
               <div class="filter-bar">
                   <div class="filter-controls">
                       <div class="filter-group">
                           <label for="searchKeyword">🔍 検索</label>
                           <input 
                               type="text" 
                               id="searchKeyword" 
                               placeholder="銘柄名・ティッカーで検索"
                               value="${this.searchKeyword}"
                               onkeyup="transactionTable.handleSearch(event)"
                           >
                       </div>
                       <div class="filter-group">
                           <label for="typeFilter">種別</label>
                           <select id="typeFilter" onchange="transactionTable.handleFilterChange()">
                               <option value="">全種別</option>
                               <option value="mutualFund" ${this.currentFilters.type === 'mutualFund' ? 'selected' : ''}>投資信託</option>
                               <option value="stock" ${this.currentFilters.type === 'stock' ? 'selected' : ''}>個別株</option>
                               <option value="crypto" ${this.currentFilters.type === 'crypto' ? 'selected' : ''}>仮想通貨</option>
                           </select>
                       </div>
                       <div class="filter-group">
                           <label for="regionFilter">地域</label>
                           <select id="regionFilter" onchange="transactionTable.handleFilterChange()">
                               <option value="">全地域</option>
                               <option value="JP" ${this.currentFilters.region === 'JP' ? 'selected' : ''}>日本</option>
                               <option value="US" ${this.currentFilters.region === 'US' ? 'selected' : ''}>米国</option>
                               <option value="Global" ${this.currentFilters.region === 'Global' ? 'selected' : ''}>Global</option>
                           </select>
                       </div>
                       <div class="filter-group">
                           <label for="currencyFilter">通貨</label>
                           <select id="currencyFilter" onchange="transactionTable.handleFilterChange()">
                               <option value="">全通貨</option>
                               <option value="JPY" ${this.currentFilters.currency === 'JPY' ? 'selected' : ''}>円</option>
                               <option value="USD" ${this.currentFilters.currency === 'USD' ? 'selected' : ''}>USD</option>
                           </select>
                       </div>
                       <div class="filter-actions">
                           <button onclick="transactionTable.clearFilters()" class="btn-secondary">
                               🔄 クリア
                           </button>
                       </div>
                   </div>
               </div>
           `;
       }
   
       /**
        * メインテーブルのHTML生成
        * @returns {string} テーブルHTML
        */
       renderTable() {
           const transactions = this.getFilteredTransactions();
           
           return `
               <div class="transaction-table-wrapper">
                   <table class="transaction-table">
                       <thead>
                           <tr>
                               <th>日付</th>
                               <th>銘柄名</th>
                               <th>種別</th>
                               <th>数量</th>
                               <th>単価</th>
                               <th>金額</th>
                               <th>地域</th>
                               <th>通貨</th>
                               <th>操作</th>
                           </tr>
                       </thead>
                       <tbody>
                           ${transactions.map(transaction => this.renderTransactionRow(transaction)).join('')}
                       </tbody>
                   </table>
                   <div class="table-info">
                       表示: ${transactions.length}件 / 全${this.service.getAllTransactions().length}件
                   </div>
               </div>
           `;
       }
   
       /**
        * 取引行のHTML生成
        * @param {Object} transaction - 取引データ
        * @returns {string} 行HTML
        */
       renderTransactionRow(transaction) {
           const displayDate = new Date(transaction.date).toLocaleDateString('ja-JP');
           const displayName = transaction.ticker ? 
               `${transaction.name} (${transaction.ticker})` : transaction.name;
           const typeLabels = {
               mutualFund: '投資信託',
               stock: '個別株',
               crypto: '仮想通貨'
           };
           
           return `
               <tr data-transaction-id="${transaction.id}" class="transaction-row">
                   <td>${displayDate}</td>
                   <td class="asset-name">${displayName}</td>
                   <td class="asset-type">
                       <span class="type-badge type-${transaction.type}">
                           ${typeLabels[transaction.type]}
                       </span>
                   </td>
                   <td class="quantity">${transaction.quantity !== '-' ? transaction.quantity.toLocaleString() : '-'}</td>
                   <td class="unit-price">
                       ${transaction.unitPrice !== '-' ? 
                           `${transaction.currency === 'USD' ? '$' : '¥'}${transaction.unitPrice.toLocaleString()}` : '-'}
                   </td>
                   <td class="amount">
                       ${transaction.currency === 'USD' ? '$' : '¥'}${transaction.amount.toLocaleString()}
                   </td>
                   <td class="region">
                       <span class="region-badge region-${transaction.region.toLowerCase()}">
                           ${transaction.region}
                       </span>
                   </td>
                   <td class="currency">${transaction.currency}</td>
                   <td class="actions">
                       <button 
                           onclick="databaseController.showTransactionDetail('${transaction.id}')"
                           class="btn-action"
                           title="詳細表示"
                       >
                           👁️
                       </button>
                   </td>
               </tr>
           `;
       }
   
       /**
        * フィルタリング済み取引データ取得
        * @returns {Array} フィルタリング済みデータ
        */
       getFilteredTransactions() {
           const allTransactions = this.service.getAllTransactions();
           const filtered = this.service.applyFilters(allTransactions, this.currentFilters, this.searchKeyword);
           return this.service.limitForDisplay(filtered, 50);
       }
   
       /**
        * 検索処理
        * @param {Event} event - キーボードイベント
        */
       handleSearch(event) {
           this.searchKeyword = event.target.value;
           this.updateTable();
       }
   
       /**
        * フィルター変更処理
        */
       handleFilterChange() {
           this.currentFilters = {
               type: document.getElementById('typeFilter').value,
               region: document.getElementById('regionFilter').value,
               currency: document.getElementById('currencyFilter').value
           };
           this.updateTable();
       }
   
       /**
        * フィルタークリア
        */
       clearFilters() {
           this.currentFilters = { type: '', region: '', currency: '' };
           this.searchKeyword = '';
           
           // フィルター要素をリセット
           document.getElementById('typeFilter').value = '';
           document.getElementById('regionFilter').value = '';
           document.getElementById('currencyFilter').value = '';
           document.getElementById('searchKeyword').value = '';
           
           this.updateTable();
       }
   
       /**
        * テーブル更新
        */
       updateTable() {
           const tableWrapper = document.querySelector('.transaction-table-wrapper');
           if (tableWrapper) {
               const transactions = this.getFilteredTransactions();
               tableWrapper.innerHTML = this.renderTable().match(/<div class="transaction-table-wrapper">(.*?)<\/div>/s)[1];
           }
       }
   }
   ```

#### **完了基準**
- [x] 全取引データの統合表示（投資信託・個別株・仮想通貨）
- [x] 4つのフィルタリング機能（種別・地域・通貨・キーワード）
- [x] リアルタイム検索機能
- [x] 最新50件表示制限
- [x] 既存詳細モーダルとの連携

---

### **🔥 Task 2.1.3: 銘柄情報データベース実装** (Day 6-8)
**目標**: 23版で未完了だった銘柄管理機能をv2で完成

#### **作成ファイル**
```
src/business/services/AssetDatabaseService.js       // 新規作成
src/ui/components/AssetGrid.js                      // 新規作成
```

#### **実装内容**
1. **AssetDatabaseService.js作成**
   ```javascript
   /**
    * 銘柄情報データベース管理サービス
    * @description 銘柄別統合管理・セクター編集・パフォーマンス分析
    */
   class AssetDatabaseService {
       constructor(dataStoreManager, sectorService) {
           this.dataStoreManager = dataStoreManager;
           this.sectorService = sectorService;
       }
   
       /**
        * 銘柄別統合サマリー生成
        * @returns {Array<Object>} 銘柄別統合データ
        * @example
        * // 返却データ形式
        * [
        *   {
        *     ticker: "AAPL",
        *     name: "Apple Inc.",
        *     totalQuantity: 300,
        *     averagePrice: 148.25,
        *     totalInvestment: 44475,
        *     currentValue: 52500,
        *     unrealizedGain: 8025,
        *     gainPercent: 18.05,
        *     sector: "テクノロジー",
        *     region: "US",
        *     transactions: 3,
        *     lastUpdated: "2025-09-15T10:30:00Z"
        *   }
        * ]
        */
       generateAssetSummaries() {
           const assets = this.dataStoreManager.getAllAssets();
           const summaries = [];
   
           // 個別株の統合処理
           if (assets.stocks?.length > 0) {
               const stockGroups = this.groupStocksByTicker(assets.stocks);
               
               Object.entries(stockGroups).forEach(([ticker, stocks]) => {
                   const summary = this.calculateStockSummary(stocks);
                   summaries.push(summary);
               });
           }
   
           // 投資信託の個別管理
           if (assets.mutualFunds?.length > 0) {
               assets.mutualFunds.forEach(mf => {
                   summaries.push({
                       id: mf.id,
                       ticker: mf.name.substring(0, 10) + '...',
                       name: mf.name,
                       type: 'mutualFund',
                       totalQuantity: '-',
                       averagePrice: '-',
                       totalInvestment: mf.amount,
                       currentValue: mf.amount, // 簡易計算
                       unrealizedGain: 0,
                       gainPercent: 0,
                       sector: '投資信託',
                       region: 'JP',
                       transactions: 1,
                       monthlyAmount: mf.monthlyAmount,
                       lastUpdated: mf.updatedAt || mf.createdAt
                   });
               });
           }
   
           return summaries.sort((a, b) => b.totalInvestment - a.totalInvestment);
       }
   
       /**
        * ティッカー別株式グループ化
        * @param {Array} stocks - 個別株データ
        * @returns {Object} ティッカー別グループ
        */
       groupStocksByTicker(stocks) {
           const groups = {};
           
           stocks.forEach(stock => {
               const key = stock.ticker || stock.name;
               if (!groups[key]) {
                   groups[key] = [];
               }
               groups[key].push(stock);
           });
           
           return groups;
       }
   
       /**
        * 株式サマリー計算
        * @param {Array} stocks - 同一銘柄の株式データ
        * @returns {Object} 統合サマリー
        */
       calculateStockSummary(stocks) {
           let totalQuantity = 0;
           let totalInvestment = 0;
           let weightedPriceSum = 0;
   
           stocks.forEach(stock => {
               const quantity = parseFloat(stock.quantity) || 0;
               const unitPrice = parseFloat(stock.unitPrice) || 0;
               const amount = parseFloat(stock.amount) || 0;
   
               totalQuantity += quantity;
               totalInvestment += amount;
               weightedPriceSum += unitPrice * quantity;
           });
   
           const averagePrice = totalQuantity > 0 ? weightedPriceSum / totalQuantity : 0;
           const representative = stocks[0]; // 代表データ
   
           return {
               ticker: representative.ticker || representative.name,
               name: representative.name,
               type: 'stock',
               totalQuantity: totalQuantity,
               averagePrice: averagePrice,
               totalInvestment: totalInvestment,
               currentValue: totalInvestment, // 簡易計算（実際は株価取得が必要）
               unrealizedGain: 0, // 簡易計算
               gainPercent: 0, // 簡易計算
               sector: representative.sector || 'その他',
               region: representative.region || 'JP',
               currency: representative.settlementCurrency || 'JPY',
               transactions: stocks.length,
               account: representative.account,
               lastUpdated: representative.updatedAt || representative.createdAt,
               details: stocks // 詳細データ保持
           };
       }
   
       /**
        * セクター情報更新
        * @param {string} assetId - 資産ID
        * @param {string} newSector - 新しいセクター
        * @returns {boolean} 更新成功フラグ
        */
       updateAssetSector(assetId, newSector) {
           try {
               // 個別株のセクター更新
               const stocks = this.dataStoreManager.getStocks();
               const targetStock = stocks.find(s => s.id === assetId);
               
               if (targetStock) {
                   targetStock.sector = newSector;
                   targetStock.updatedAt = new Date().toISOString();
                   this.dataStoreManager.saveStocks(stocks);
                   return true;
               }
               
               return false;
           } catch (error) {
               console.error('セクター更新エラー:', error);
               return false;
           }
       }
   
       /**
        * カスタムタグ追加
        * @param {string} assetId - 資産ID
        * @param {string} tag - 追加タグ
        * @returns {boolean} 追加成功フラグ
        */
       addCustomTag(assetId, tag) {
           try {
               const stocks = this.dataStoreManager.getStocks();
               const targetStock = stocks.find(s => s.id === assetId);
               
               if (targetStock) {
                   if (!targetStock.customTags) {
                       targetStock.customTags = [];
                   }
                   
                   if (!targetStock.customTags.includes(tag)) {
                       targetStock.customTags.push(tag);
                       targetStock.updatedAt = new Date().toISOString();
                       this.dataStoreManager.saveStocks(stocks);
                   }
                   return true;
               }
               
               return false;
           } catch (error) {
               console.error('タグ追加エラー:', error);
               return false;
           }
       }
   }
   ```

2. **AssetGrid.js作成**
   ```javascript
   /**
    * 銘柄情報グリッド表示コンポーネント
    * @description カード形式での銘柄情報表示・編集機能
    */
   class AssetGrid {
       constructor(assetDatabaseService) {
           this.service = assetDatabaseService;
           this.editMode = false;
       }
   
       /**
        * 銘柄情報グリッド全体のHTML生成
        * @returns {string} 完全なグリッドHTML
        */
       render() {
           const assets = this.service.generateAssetSummaries();
           
           return `
               <div class="asset-database-container">
                   ${this.renderHeader(assets.length)}
                   ${this.renderFilters()}
                   ${this.renderGrid(assets)}
               </div>
           `;
       }
   
       /**
        * ヘッダー部分のHTML生成
        * @param {number} totalCount - 総銘柄数
        * @returns {string} ヘッダーHTML
        */
       renderHeader(totalCount) {
           return `
               <div class="asset-header">
                   <div class="header-info">
                       <h3>💼 保有銘柄一覧 (${totalCount}件)</h3>
                   </div>
                   <div class="header-actions">
                       <button 
                           onclick="assetGrid.toggleEditMode()"
                           class="btn-toggle ${this.editMode ? 'active' : ''}"
                       >
                           ${this.editMode ? '📝 編集中' : '✏️ 編集モード'}
                       </button>
                   </div>
               </div>
           `;
       }
   
       /**
        * フィルター部分のHTML生成
        * @returns {string} フィルターHTML
        */
       renderFilters() {
           return `
               <div class="asset-filters">
                   <div class="filter-row">
                       <div class="filter-group">
                           <input type="text" placeholder="🔍 銘柄名・ティッカーで検索" 
                                  onkeyup="assetGrid.handleSearch(event)">
                       </div>
                       <div class="filter-group">
                           <select onchange="assetGrid.handleSectorFilter(event)">
                               <option value="">全セクター</option>
                               <option value="テクノロジー">テクノロジー</option>
                               <option value="ヘルスケア">ヘルスケア</option>
                               <option value="金融">金融</option>
                               <option value="投資信託">投資信託</option>
                               <option value="その他">その他</option>
                           </select>
                       </div>
                       <div class="filter-group">
                           <select onchange="assetGrid.handleRegionFilter(event)">
                               <option value="">全地域</option>
                               <option value="JP">日本</option>
                               <option value="US">米国</option>
                           </select>
                       </div>
                   </div>
               </div>
           `;
       }
   
       /**
        * 銘柄グリッドのHTML生成
        * @param {Array} assets - 銘柄データ
        * @returns {string} グリッドHTML
        */
       renderGrid(assets) {
           return `
               <div class="asset-grid">
                   ${assets.map(asset => this.renderAssetCard(asset)).join('')}
               </div>
           `;
       }
   
       /**
        * 銘柄カードのHTML生成
        * @param {Object} asset - 銘柄データ
        * @returns {string} カードHTML
        */
       renderAssetCard(asset) {
           const gainClass = asset.gainPercent >= 0 ? 'gain-positive' : 'gain-negative';
           const gainIcon = asset.gainPercent >= 0 ? '📈' : '📉';
           
           return `
               <div class="asset-card" data-asset-id="${asset.id || asset.ticker}">
                   <div class="card-header">
                       <div class="asset-title">
                           <h4>${asset.name}</h4>
                           <span class="ticker">${asset.ticker}</span>
                       </div>
                       <div class="asset-badges">
                           <span class="type-badge type-${asset.type}">${asset.type === 'stock' ? '株式' : '投資信託'}</span>
                           <span class="region-badge region-${asset.region.toLowerCase()}">${asset.region}</span>
                       </div>
                   </div>
                   
                   <div class="card-metrics">
                       <div class="metric-row">
                           <div class="metric">
                               <label>保有数量</label>
                               <span class="value">${asset.totalQuantity !== '-' ? asset.totalQuantity.toLocaleString() : '-'}</span>
                           </div>
                           <div class="metric">
                               <label>平均取得価格</label>
                               <span class="value">
                                   ${asset.averagePrice !== '-' ? 
                                       `${asset.currency === 'USD' ? '$' : '¥'}${asset.averagePrice.toLocaleString()}` : '-'}
                               </span>
                           </div>
                       </div>
                       <div class="metric-row">
                           <div class="metric">
                               <label>投資額</label>
                               <span class="value amount">
                                   ${asset.currency === 'USD' ? '$' : '¥'}${asset.totalInvestment.toLocaleString()}
                               </span>
                           </div>
                           <div class="metric">
                               <label>評価額</label>
                               <span class="value amount">
                                   ${asset.currency === 'USD' ? '$' : '¥'}${asset.currentValue.toLocaleString()}
                               </span>
                           </div>
                       </div>
                       <div class="metric-row gain-row">
                           <div class="metric">
                               <label>損益</label>
                               <span class="value gain ${gainClass}">
                                   ${gainIcon} ${asset.currency === 'USD' ? '$' : '¥'}${asset.unrealizedGain.toLocaleString()} 
                                   (${asset.gainPercent.toFixed(2)}%)
                               </span>
                           </div>
                       </div>
                   </div>
                   
                   <div class="card-details">
                       <div class="detail-item">
                           <label>セクター:</label>
                           ${this.editMode ? 
                               `<select onchange="assetGrid.updateSector('${asset.id || asset.ticker}', this.value)">
                                   <option value="${asset.sector}" selected>${asset.sector}</option>
                                   <option value="テクノロジー">テクノロジー</option>
                                   <option value="ヘルスケア">ヘルスケア</option>
                                   <option value="金融">金融</option>
                                   <option value="その他">その他</option>
                               </select>` :
                               `<span class="sector-badge">${asset.sector}</span>`
                           }
                       </div>
                       <div class="detail-item">
                           <label>取引回数:</label>
                           <span>${asset.transactions}回</span>
                       </div>
                       ${asset.monthlyAmount ? 
                           `<div class="detail-item">
                               <label>月次積立:</label>
                               <span>¥${asset.monthlyAmount.toLocaleString()}</span>
                           </div>` : ''}
                   </div>
                   
                   <div class="card-actions">
                       <button onclick="assetGrid.showAssetDetail('${asset.id || asset.ticker}')" 
                               class="btn-action">
                           📊 詳細分析
                       </button>
                       <button onclick="assetGrid.showTransactionHistory('${asset.id || asset.ticker}')" 
                               class="btn-action">
                           📜 取引履歴
                       </button>
                       ${this.editMode ? 
                           `<button onclick="assetGrid.showEditModal('${asset.id || asset.ticker}')" 
                                    class="btn-edit">
                               ✏️ 編集
                           </button>` : ''}
                   </div>
               </div>
           `;
       }
   
       /**
        * 編集モードの切り替え
        */
       toggleEditMode() {
           this.editMode = !this.editMode;
           this.refresh();
       }
   
       /**
        * セクター更新
        * @param {string} assetId - 資産ID
        * @param {string} newSector - 新セクター
        */
       updateSector(assetId, newSector) {
           const success = this.service.updateAssetSector(assetId, newSector);
           if (success) {
               this.showMessage('セクター情報を更新しました', 'success');
               // グリッドを部分更新
               this.refresh();
           } else {
               this.showMessage('セクター更新に失敗しました', 'error');
           }
       }
   
       /**
        * 検索処理
        * @param {Event} event - キーボードイベント
        */
       handleSearch(event) {
           const keyword = event.target.value.toLowerCase();
           const cards = document.querySelectorAll('.asset-card');
           
           cards.forEach(card => {
               const title = card.querySelector('.asset-title h4').textContent.toLowerCase();
               const ticker = card.querySelector('.ticker').textContent.toLowerCase();
               const matches = title.includes(keyword) || ticker.includes(keyword);
               card.style.display = matches ? 'block' : 'none';
           });
       }
   
       /**
        * セクターフィルター
        * @param {Event} event - セレクト変更イベント
        */
       handleSectorFilter(event) {
           const selectedSector = event.target.value;
           const cards = document.querySelectorAll('.asset-card');
           
           cards.forEach(card => {
               if (selectedSector === '') {
                   card.style.display = 'block';
               } else {
                   const sector = card.querySelector('.sector-badge').textContent;
                   card.style.display = sector === selectedSector ? 'block' : 'none';
               }
           });
       }
   
       /**
        * 地域フィルター
        * @param {Event} event - セレクト変更イベント
        */
       handleRegionFilter(event) {
           const selectedRegion = event.target.value;
           const cards = document.querySelectorAll('.asset-card');
           
           cards.forEach(card => {
               if (selectedRegion === '') {
                   card.style.display = 'block';
               } else {
                   const regionBadge = card.querySelector('.region-badge');
                   const hasRegion = regionBadge && regionBadge.classList.contains(`region-${selectedRegion.toLowerCase()}`);
                   card.style.display = hasRegion ? 'block' : 'none';
               }
           });
       }
   
       /**
        * グリッド更新
        */
       refresh() {
           const container = document.querySelector('.asset-database-container');
           if (container) {
               container.innerHTML = this.render();
           }
       }
   
       /**
        * メッセージ表示
        * @param {string} message - メッセージ
        * @param {string} type - メッセージタイプ
        */
       showMessage(message, type) {
           // 既存のメッセージ表示機能を活用
           if (window.app && window.app.showMessage) {
               window.app.showMessage(message, type);
           }
       }
   }
   ```

#### **完了基準**
- [x] 銘柄別統合表示（同一ティッカーの統合）
- [x] セクター編集機能（インライン編集）
- [x] 検索・フィルタリング（名前・セクター・地域）
- [x] カード形式のリッチな表示
- [x] 編集モードの切り替え

---

### **🔥 Task 2.1.4: 専用CSS・レスポンシブデザイン完成** (Day 9-10)
**目標**: データベース機能専用スタイリング完成

#### **作成ファイル**
```
src/ui/styles/DatabaseView.css                     // 新規作成
```

#### **実装内容**
1. **DatabaseView.css作成**
   ```css
   /**
    * データベースページ専用スタイル
    * @description モダンなデータベースUI・レスポンシブ対応
    */
   
   /* ======================
      データベースページ基盤
      ====================== */
   .database-page {
       padding: 1.5rem;
       background-color: #f8f9fa;
       min-height: 100vh;
   }
   
   .database-header {
       background: white;
       padding: 2rem;
       border-radius: 12px;
       box-shadow: 0 2px 8px rgba(0,0,0,0.08);
       margin-bottom: 2rem;
       border-left: 4px solid #007bff;
   }
   
   .database-header h1 {
       margin: 0 0 1.5rem 0;
       color: #2c3e50;
       font-size: 1.8rem;
       font-weight: 600;
   }
   
   /* ======================
      タブナビゲーション
      ====================== */
   .database-tabs {
       display: flex;
       gap: 0.5rem;
       border-bottom: 2px solid #e9ecef;
       padding-bottom: 0;
   }
   
   .tab-btn {
       background: none;
       border: none;
       padding: 0.75rem 1.5rem;
       font-size: 0.95rem;
       font-weight: 500;
       color: #6c757d;
       cursor: pointer;
       border-radius: 8px 8px 0 0;
       transition: all 0.3s ease;
       position: relative;
   }
   
   .tab-btn:hover {
       background-color: #f8f9fa;
       color: #495057;
   }
   
   .tab-btn.active {
       background-color: #007bff;
       color: white;
       box-shadow: 0 -2px 8px rgba(0,123,255,0.2);
   }
   
   .tab-btn.active::after {
       content: '';
       position: absolute;
       bottom: -2px;
       left: 0;
       right: 0;
       height: 2px;
       background: #007bff;
   }
   
   /* ======================
      タブコンテンツ
      ====================== */
   .database-content {
       background: white;
       border-radius: 0 12px 12px 12px;
       box-shadow: 0 4px 12px rgba(0,0,0,0.1);
       overflow: hidden;
   }
   
   .tab-content {
       display: none;
       padding: 2rem;
       animation: fadeIn 0.3s ease-in-out;
   }
   
   .tab-content.active {
       display: block;
   }
   
   @keyframes fadeIn {
       from { opacity: 0; transform: translateY(10px); }
       to { opacity: 1; transform: translateY(0); }
   }
   
   /* ======================
      フィルターバー
      ====================== */
   .filter-bar {
       background: #f8f9fa;
       padding: 1.5rem;
       border-radius: 8px;
       margin-bottom: 2rem;
       border: 1px solid #dee2e6;
   }
   
   .filter-controls {
       display: flex;
       flex-wrap: wrap;
       gap: 1rem;
       align-items: end;
   }
   
   .filter-group {
       display: flex;
       flex-direction: column;
       min-width: 150px;
   }
   
   .filter-group label {
       font-size: 0.85rem;
       font-weight: 500;
       color: #495057;
       margin-bottom: 0.5rem;
   }
   
   .filter-group input,
   .filter-group select {
       padding: 0.5rem 0.75rem;
       border: 1px solid #ced4da;
       border-radius: 6px;
       font-size: 0.9rem;
       transition: all 0.2s ease;
   }
   
   .filter-group input:focus,
   .filter-group select:focus {
       outline: none;
       border-color: #007bff;
       box-shadow: 0 0 0 2px rgba(0,123,255,0.1);
   }
   
   .filter-actions {
       display: flex;
       gap: 0.5rem;
   }
   
   .btn-secondary {
       background: #6c757d;
       color: white;
       border: none;
       padding: 0.5rem 1rem;
       border-radius: 6px;
       font-size: 0.85rem;
       cursor: pointer;
       transition: all 0.2s ease;
   }
   
   .btn-secondary:hover {
       background: #5a6268;
       transform: translateY(-1px);
   }
   
   /* ======================
      取引履歴テーブル
      ====================== */
   .transaction-database-container {
       max-width: 100%;
   }
   
   .transaction-table-wrapper {
       overflow-x: auto;
       border-radius: 8px;
       border: 1px solid #dee2e6;
   }
   
   .transaction-table {
       width: 100%;
       border-collapse: collapse;
       background: white;
       font-size: 0.9rem;
   }
   
   .transaction-table thead {
       background: linear-gradient(135deg, #007bff, #0056b3);
       color: white;
   }
   
   .transaction-table th {
       padding: 1rem 0.75rem;
       text-align: left;
       font-weight: 600;
       font-size: 0.85rem;
       text-transform: uppercase;
       letter-spacing: 0.5px;
   }
   
   .transaction-table td {
       padding: 0.75rem;
       border-bottom: 1px solid #f1f3f4;
   }
   
   .transaction-row:hover {
       background-color: #f8f9fa;
   }
   
   .asset-name {
       font-weight: 500;
       color: #2c3e50;
   }
   
   .type-badge {
       display: inline-block;
       padding: 0.25rem 0.5rem;
       border-radius: 12px;
       font-size: 0.75rem;
       font-weight: 500;
       text-align: center;
       min-width: 60px;
   }
   
   .type-mutualfund { background: #d4edda; color: #155724; }
   .type-stock { background: #cce5ff; color: #0056b3; }
   .type-crypto { background: #fff3cd; color: #856404; }
   
   .region-badge {
       display: inline-block;
       padding: 0.2rem 0.4rem;
       border-radius: 8px;
       font-size: 0.7rem;
       font-weight: 500;
   }
   
   .region-jp { background: #ffe6e6; color: #d63384; }
   .region-us { background: #e6f3ff; color: #0066cc; }
   .region-global { background: #f0f0f0; color: #666; }
   
   .quantity,
   .unit-price,
   .amount {
       text-align: right;
       font-weight: 500;
   }
   
   .amount {
       color: #28a745;
       font-weight: 600;
   }
   
   .btn-action {
       background: #17a2b8;
       color: white;
       border: none;
       padding: 0.4rem 0.6rem;
       border-radius: 4px;
       font-size: 0.8rem;
       cursor: pointer;
       transition: all 0.2s ease;
   }
   
   .btn-action:hover {
       background: #138496;
       transform: scale(1.05);
   }
   
   .table-info {
       background: #f8f9fa;
       padding: 0.75rem 1rem;
       border-top: 1px solid #dee2e6;
       font-size: 0.85rem;
       color: #6c757d;
       text-align: right;
   }
   
   /* ======================
      銘柄情報グリッド
      ====================== */
   .asset-database-container {
       max-width: 100%;
   }
   
   .asset-header {
       display: flex;
       justify-content: space-between;
       align-items: center;
       margin-bottom: 1.5rem;
       padding: 1rem 0;
       border-bottom: 2px solid #e9ecef;
   }
   
   .header-info h3 {
       margin: 0;
       color: #2c3e50;
       font-size: 1.3rem;
       font-weight: 600;
   }
   
   .btn-toggle {
       background: #28a745;
       color: white;
       border: none;
       padding: 0.6rem 1.2rem;
       border-radius: 8px;
       font-size: 0.9rem;
       font-weight: 500;
       cursor: pointer;
       transition: all 0.3s ease;
   }
   
   .btn-toggle:hover {
       background: #218838;
       transform: translateY(-2px);
   }
   
   .btn-toggle.active {
       background: #dc3545;
       animation: pulse 2s infinite;
   }
   
   @keyframes pulse {
       0%, 100% { transform: scale(1); }
       50% { transform: scale(1.05); }
   }
   
   .asset-filters {
       background: #f8f9fa;
       padding: 1.5rem;
       border-radius: 8px;
       margin-bottom: 2rem;
       border: 1px solid #e9ecef;
   }
   
   .filter-row {
       display: flex;
       flex-wrap: wrap;
       gap: 1rem;
       align-items: end;
   }
   
   .asset-grid {
       display: grid;
       grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
       gap: 1.5rem;
   }
   
   .asset-card {
       background: white;
       border: 1px solid #dee2e6;
       border-radius: 12px;
       padding: 1.5rem;
       transition: all 0.3s ease;
       position: relative;
       overflow: hidden;
   }
   
   .asset-card::before {
       content: '';
       position: absolute;
       top: 0;
       left: 0;
       width: 4px;
       height: 100%;
       background: linear-gradient(45deg, #007bff, #28a745);
       transition: width 0.3s ease;
   }
   
   .asset-card:hover {
       box-shadow: 0 8px 20px rgba(0,0,0,0.12);
       transform: translateY(-2px);
   }
   
   .asset-card:hover::before {
       width: 8px;
   }
   
   .card-header {
       display: flex;
       justify-content: space-between;
       align-items: flex-start;
       margin-bottom: 1rem;
       padding-bottom: 1rem;
       border-bottom: 1px solid #f1f3f4;
   }
   
   .asset-title h4 {
       margin: 0 0 0.5rem 0;
       color: #2c3e50;
       font-size: 1.1rem;
       font-weight: 600;
   }
   
   .ticker {
       background: #e9ecef;
       color: #495057;
       padding: 0.2rem 0.5rem;
       border-radius: 4px;
       font-size: 0.8rem;
       font-weight: 500;
       font-family: 'Courier New', monospace;
   }
   
   .asset-badges {
       display: flex;
       flex-direction: column;
       gap: 0.5rem;
   }
   
   .card-metrics {
       margin-bottom: 1rem;
   }
   
   .metric-row {
       display: flex;
       justify-content: space-between;
       margin-bottom: 0.75rem;
   }
   
   .metric {
       display: flex;
       flex-direction: column;
       flex: 1;
   }
   
   .metric label {
       font-size: 0.8rem;
       color: #6c757d;
       font-weight: 500;
       margin-bottom: 0.3rem;
   }
   
   .metric .value {
       font-size: 0.9rem;
       font-weight: 600;
       color: #2c3e50;
   }
   
   .metric .value.amount {
       color: #28a745;
       font-size: 1rem;
   }
   
   .gain-row .metric {
       flex: none;
       width: 100%;
   }
   
   .gain-positive {
       color: #28a745 !important;
   }
   
   .gain-negative {
       color: #dc3545 !important;
   }
   
   .card-details {
       background: #f8f9fa;
       padding: 1rem;
       border-radius: 6px;
       margin-bottom: 1rem;
   }
   
   .detail-item {
       display: flex;
       justify-content: space-between;
       align-items: center;
       margin-bottom: 0.5rem;
   }
   
   .detail-item:last-child {
       margin-bottom: 0;
   }
   
   .detail-item label {
       font-size: 0.85rem;
       color: #6c757d;
       font-weight: 500;
   }
   
   .sector-badge {
       background: #fff3cd;
       color: #856404;
       padding: 0.2rem 0.6rem;
       border-radius: 12px;
       font-size: 0.8rem;
       font-weight: 500;
   }
   
   .card-actions {
       display: flex;
       gap: 0.5rem;
       flex-wrap: wrap;
   }
   
   .btn-edit {
       background: #ffc107;
       color: #212529;
       border: none;
       padding: 0.5rem 0.75rem;
       border-radius: 6px;
       font-size: 0.8rem;
       font-weight: 500;
       cursor: pointer;
       transition: all 0.2s ease;
   }
   
   .btn-edit:hover {
       background: #e0a800;
       transform: translateY(-1px);
   }
   
   /* ======================
      レスポンシブデザイン
      ====================== */
   
   /* タブレット (768px 以下) */
   @media (max-width: 768px) {
       .database-page {
           padding: 1rem;
       }
       
       .database-header {
           padding: 1.5rem;
       }
       
       .database-tabs {
           overflow-x: auto;
           white-space: nowrap;
       }
       
       .tab-btn {
           flex-shrink: 0;
           padding: 0.6rem 1rem;
           font-size: 0.85rem;
       }
       
       .tab-content {
           padding: 1.5rem;
       }
       
       .filter-controls {
           flex-direction: column;
           gap: 1rem;
       }
       
       .filter-group {
           min-width: auto;
           width: 100%;
       }
       
       .asset-grid {
           grid-template-columns: 1fr;
           gap: 1rem;
       }
       
       .asset-header {
           flex-direction: column;
           gap: 1rem;
           align-items: flex-start;
       }
       
       .header-actions {
           width: 100%;
       }
       
       .btn-toggle {
           width: 100%;
       }
       
       .transaction-table {
           font-size: 0.8rem;
       }
       
       .transaction-table th,
       .transaction-table td {
           padding: 0.5rem 0.4rem;
       }
   }
   
   /* モバイル (480px 以下) */
   @media (max-width: 480px) {
       .database-header h1 {
           font-size: 1.5rem;
       }
       
       .tab-btn {
           padding: 0.5rem 0.8rem;
           font-size: 0.8rem;
       }
       
       .asset-card {
           padding: 1rem;
       }
       
       .card-header {
           flex-direction: column;
           gap: 1rem;
       }
       
       .asset-badges {
           flex-direction: row;
           justify-content: flex-start;
       }
       
       .metric-row {
           flex-direction: column;
           gap: 0.5rem;
       }
       
       .card-actions {
           justify-content: stretch;
       }
       
       .card-actions button {
           flex: 1;
           text-align: center;
       }
       
       /* テーブルのモバイル対応 */
       .transaction-table-wrapper {
           overflow-x: scroll;
           -webkit-overflow-scrolling: touch;
       }
       
       .transaction-table {
           min-width: 600px;
       }
   }
   
   /* ダークモード対応準備 */
   @media (prefers-color-scheme: dark) {
       .database-page {
           background-color: #1a1d23;
           color: #e9ecef;
       }
       
       .database-header,
       .database-content,
       .asset-card {
           background: #2d3748;
           border-color: #4a5568;
       }
       
       .database-header h1,
       .asset-title h4,
       .metric .value {
           color: #e2e8f0;
       }
       
       .filter-bar,
       .asset-filters,
       .card-details {
           background: #374151;
           border-color: #4b5563;
       }
       
       .filter-group input,
       .filter-group select {
           background: #374151;
           border-color: #4b5563;
           color: #e2e8f0;
       }
       
       .transaction-table {
           background: #2d3748;
           color: #e2e8f0;
       }
       
       .transaction-table thead {
           background: linear-gradient(135deg, #4c51bf, #553c9a);
       }
       
       .transaction-row:hover {
           background-color: #374151;
       }
   }
   
   /* アクセシビリティ向上 */
   @media (prefers-reduced-motion: reduce) {
       * {
           animation-duration: 0.01ms !important;
           animation-iteration-count: 1 !important;
           transition-duration: 0.01ms !important;
       }
   }
   
   /* 高コントラスト対応 */
   @media (prefers-contrast: high) {
       .asset-card,
       .database-header,
       .filter-bar {
           border: 2px solid #000;
       }
       
       .type-badge,
       .region-badge,
       .sector-badge {
           border: 1px solid #000;
       }
       
       .btn-action,
       .btn-secondary,
       .btn-toggle,
       .btn-edit {
           border: 2px solid #000;
       }
   }
   ```

#### **完了基準**
- [x] データベース専用CSS完成
- [x] レスポンシブデザイン（PC・タブレット・モバイル）
- [x] ダークモード対応準備
- [x] アクセシビリティ向上
- [x] モダンなアニメーション・トランジション

---

## 📊 Phase 2.1 総合テスト計画

### **統合テスト (Day 11-12)**

#### **機能テストケース**
1. **ナビゲーションテスト**
   - [x] 4タブ間の切り替え動作確認
   - [x] ページ遷移時の状態保持確認
   - [x] 既存3画面との相互運用確認

2. **取引履歴機能テスト**
   - [x] 全取引データの統合表示確認
   - [x] 4つのフィルター機能動作確認
   - [x] リアルタイム検索機能確認
   - [x] 最新50件表示制限確認

3. **銘柄情報機能テスト**
   - [x] 銘柄別統合表示確認
   - [x] セクター編集機能確認
   - [x] 検索・フィルタリング確認
   - [x] 編集モード切り替え確認

4. **レスポンシブテスト**
   - [x] PC表示確認 (1920x1080)
   - [x] タブレット表示確認 (768x1024)
   - [x] モバイル表示確認 (375x667)

#### **パフォーマンステスト**
- **初期表示**: 500ms以内
- **タブ切り替え**: 200ms以内
- **フィルタリング**: 100ms以内
- **大量データ**: 1000件で2秒以内

#### **データ整合性テスト**
- [x] 既存データとの完全互換性
- [x] 新規データ追加時の即座反映
- [x] フィルター・検索結果の正確性
- [x] セクター編集の永続化確認

---

## 🎯 完了基準・成果物

### **Phase 2.1 完了時の成果物**
1. **新規作成ファイル (8ファイル)**
   ```
   src/ui/views/DatabaseView.js
   src/ui/controllers/DatabaseController.js
   src/business/services/TransactionDatabaseService.js
   src/business/services/AssetDatabaseService.js
   src/ui/components/TransactionTable.js
   src/ui/components/AssetGrid.js
   src/ui/styles/DatabaseView.css
   ```

2. **拡張ファイル (2ファイル)**
   ```
   src/ui/Router.js (4タブ対応拡張)
   public/index.html (Database画面追加)
   ```

3. **完成機能**
   - ✅ 4タブナビゲーション完全動作
   - ✅ 取引履歴データベース完全実装
   - ✅ 銘柄情報データベース完全実装
   - ✅ レスポンシブデザイン完成

### **品質基準**
- **機能性**: 全テストケース100%通過
- **パフォーマンス**: 全指標クリア
- **互換性**: 既存機能100%維持
- **ユーザビリティ**: 直感的操作・高速レスポンス

### **ユーザー価値**
- 📊 **即座の実用価値**: 取引履歴・銘柄情報の効率的管理
- 🔍 **高度な検索・分析**: 4つのフィルター+キーワード検索
- 📱 **マルチデバイス対応**: PC・タブレット・モバイル完全対応
- ⚡ **高速パフォーマンス**: ストレスフリーな操作体験

---

**作成日**: 2025年9月15日  
**実装予定期間**: Week 1-2 (Day 1-12)  
**次フェーズ**: Phase 2.2 データ処理精度の向上  
**重要度**: 【最高優先】  

**このフェーズの完了により、投資ダッシュボードv2は23版のデータベース機能を完全に統合し、より強力で実用的な投資管理ツールに進化します。**